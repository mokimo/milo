!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e||self).milo=t()}(this,function(){function e(e,t){return t||(t=e.slice(0)),e.raw=t,e}function t(e){var t=[].slice.call(arguments,1),n=e.reduce(function(e,n,a){return t[a]instanceof HTMLElement?e+n+'<elem ref="'+a+'"></elem>':e+n+(t[a]||"")},""),a=document.createRange().createContextualFragment(n).children[0];return Array.prototype.map.call(a.querySelectorAll("elem"),function(e){var n=e.getAttribute("ref");e.replaceWith(t[n])}),a}var n,a,i,o="is-open",s=document.querySelector(".gnav-curtain")||document.querySelector(".feds-curtainWrapper"),r=function(){var e=this;this.toggleOnSpace=function(t){if("Space"===t.code){t.preventDefault();var n=t.target.closest(".has-menu");e.toggleMenu(n)}},this.closeOnScroll=function(){var t;t||(e.state.openMenu&&e.toggleMenu(e.state.openMenu),t=!0,document.removeEventListener("scroll",e.closeOnScroll))},this.toggleMenu=function(t){var n=t.classList.contains("feds-search"),a=t===e.state.openMenu;e.state.openMenu&&e.closeMenu(),a||e.openMenu(t,n)},this.closeOnEscape=function(t){"Escape"===t.code&&e.toggleMenu(e.state.openMenu)},this.closeOnDocClick=function(t){var n=t.target.closest(".is-open"),a=t.target===s;(e.state.openMenu&&!n||a)&&e.toggleMenu(e.state.openMenu),a&&s.classList.remove("is-open")},this.openMenu=function(t,n){t.classList.add(o);var a=t.querySelector("[aria-expanded]");a.setAttribute("aria-expanded",!0),a.setAttribute("daa-lh","header|Close"),document.addEventListener("click",e.closeOnDocClick),window.addEventListener("keydown",e.closeOnEscape),n?(s.classList.add("is-open"),t.querySelector(".feds-search-input")&&t.querySelector(".feds-search-input").focus()):window.matchMedia("(min-width: 900px)").matches&&(document.addEventListener("scroll",e.closeOnScroll,{passive:!0}),t.classList.contains("large-menu")&&s.classList.add("is-open","is-quiet")),e.state.openMenu=t},this.closeMenu=function(){e.state.openMenu.classList.remove(o),s.classList.remove("is-open"),s.classList.remove("is-quiet"),document.removeEventListener("click",e.closeOnDocClick),window.removeEventListener("keydown",e.closeOnEscape);var t=e.state.openMenu.querySelector("[aria-expanded]");t.setAttribute("aria-expanded",!1),t.setAttribute("daa-lh","header|Open"),e.state.openMenu=null},this.state={}};"undefined"==typeof Symbol||Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"));var c,l,u,d,p,m,f=function(e,t){return e},g=function(a){return a?(a.href=f(a.href),t(n||(n=e(['<li class="gnav-profile-action">',"</li>"])),a)):""},h=/*#__PURE__*/function(){function n(e){var t=e.decoratedEl,n=e.avatarImg,a=e.sections,i=e.toggleMenu,o=e.profileButton,s=e.accountLink,r=e.signOutEl,c=e.manageTeams,l=e.manageEnterprise;console.log(s),this.sections=a,this.avatarImg=n,this.accountLink=s,this.signOutEl=r,this.manageTeams=c,this.manageEnterprise=l,this.toggleMenu=i,this.profileButton=o,this.decoratedEl=t,this.init()}var o=n.prototype;return o.init=function(){try{var e=this;return Promise.resolve(window.adobeIMS.getProfile()).then(function(t){var n=t.displayName,a=t.email;e.profileButton&&e.profileButton.setAttribute("aria-label",n),e.displayName=n,e.email=a,e.decoratedEl.append(e.menu()),e.decoratedEl.addEventListener("click",function(){return e.toggleMenu(e.decoratedEl)}),e.decoratedEl.dispatchEvent(new Event("profile_ready"))})}catch(e){return Promise.reject(e)}},o.decorateSignOut=function(){var n=t(a||(a=e(['<li class="gnav-profile-action">',"</li>"])),this.signOutEl);return n.addEventListener("click",function(e){e.preventDefault(),window.adobeIMS.signOut()}),n},o.menu=function(){var n,a,o,s,r,c,l;return t(i||(i=e(['\n      <div id="gnav-profile-menu" class="gnav-profile-menu">\n        <a \n          href="','" \n          class="gnav-profile-header"\n          aria-label="','"\n        >\n          ','\n          <div class="gnav-profile-details">\n            <p class="gnav-profile-name">','</p>\n            <p class="gnav-profile-email">','</p>\n            <p class="gnav-profile-account">','</p>\n          </div>\n        </a>\n        <ul class="gnav-profile-actions">\n          ',"\n          ","\n          ","\n        </ul>\n      </div>\n    "])),f(this.accountLink.href),this.accountLink.textContent,this.avatarImg.cloneNode(!0),this.displayName,(s=(o=this.email.split("@"))[0].length<=12?o[0]:o[0].slice(0,12)+"…",c=(r=o[1].split(".")).pop(),s+"@"+(l=(l=r.join(".")).length<=12?l:l.slice(0,12)+"…")+"."+c),this.accountLink.innerHTML,null!=(n=this.sections.manage.items.team)&&n.id?g(this.manageTeams):"",null!=(a=this.sections.manage.items.enterprise)&&a.id?g(this.manageEnterprise):"",this.decorateSignOut())},n}(),v=function(){try{var n=function(n){return Promise.resolve(n.json()).then(function(n){var a=n.sections,i=n.user.avatar,o=t(c||(c=e(['<img class="gnav-profile-img" src="','"></img>'])),i),s=t(l||(l=e(['<a href="https://account.adobe.com/">Sign Out</a>']))),f=t(u||(u=e(['<a href="https://adminconsole.adobe.com/team">Manage Team</a>']))),g=t(d||(d=e(['<a href="https://adminconsole.adobe.com/">Manage Enterprise</a>']))),v=t(p||(p=e(['<a href="https://account.adobe.com/">View Account</a>']))),M=t(m||(m=e(['\n  <div class="gnav-profile">\n    <button class="gnav-profile-button" aria-expanded="false" aria-controls="gnav-profile-menu" aria-label="Okan Sahin"> \n    <img class="gnav-profile-img" src="https://pps-stage.services.adobe.com/api/profile/image/default/65ed0931-9318-4ee1-b21f-a6718e9e0c79/138">\n    </button>\n  </div>\n']))),b=new h({accountLink:v,decoratedEl:M,toggleMenu:(new r).toggleMenu,avatarImg:o,sections:a,signOutEl:s,manageTeams:f,manageEnterprise:g});return document.querySelector(".the-target").parentNode.replaceChild(M,document.querySelector(".the-target")),b})},a=window.adobeIMS.getAccessToken();return Promise.resolve(a?Promise.resolve(fetch("https://cc-collab-stage.adobe.io/profile",{headers:new Headers({Authorization:"Bearer "+a.token})})).then(n):n({}))}catch(e){return Promise.reject(e)}};return window.adobeProfile=v,v});
